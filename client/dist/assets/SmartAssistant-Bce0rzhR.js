import{a as s,j as a,p as e,u as t,b as n,s as l,r as i,v as r,w as c,x as o,y as d,z as m,A as u,B as h,C as x,h as j}from"./index-DmK7u7M1.js";import{r as v}from"./vendor-X31hiD63.js";import"./icons-jm45AAY8.js";function p({isOpen:p,onClose:b,showToast:N}){var g,y,f;const[q,k]=v.useState([]),[w,C]=v.useState(""),[S,E]=v.useState(!1),[W,$]=v.useState(null),[I,T]=v.useState("chat"),[z,A]=v.useState(null),D=v.useRef(null),H=v.useRef(null);v.useEffect(()=>{var s;p&&(R(),_(),null==(s=H.current)||s.focus(),0===q.length&&k([{role:"assistant",content:K()}]))},[p]),v.useEffect(()=>{var s;null==(s=D.current)||s.scrollIntoView({behavior:"smooth"})},[q]);const K=()=>{const s=(new Date).getHours();let a="Ù…Ø±Ø­Ø¨Ø§Ù‹";return a=s<12?"ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±":s<18?"Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±":"Ù…Ø³Ø§Ø¡ Ø§Ù„Ù†ÙˆØ±",`${a}! ðŸ‘‹\n\nØ£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙØ§Øª. ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:\n\nâ€¢ ðŸ“Š ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ®Ø²ÙŠÙ† ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©\nâ€¢ ðŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù„ÙØ§Øª\nâ€¢ ðŸ“ ØªÙ†Ø¸ÙŠÙ… Ù…Ù„ÙØ§ØªÙƒ\nâ€¢ ðŸ’¡ ØªÙ‚Ø¯ÙŠÙ… Ù†ØµØ§Ø¦Ø­ Ø°ÙƒÙŠØ©\n\nÙƒÙŠÙ Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯ÙƒØŸ`},R=async()=>{try{const a=await s.get("/api/smart-ai/status");$(a.data)}catch(a){}},_=async()=>{try{const a=await s.get("/api/smart-ai/analyze");A(a.data.analysis)}catch(a){}},B=async(a=w)=>{if(!a.trim()||S)return;const e={role:"user",content:a};k(s=>[...s,e]),C(""),E(!0);try{const e=await s.post("/api/smart-ai/chat",{message:a});k(s=>[...s,{role:"assistant",content:e.data.response,method:e.data.method,provider:e.data.provider}])}catch(t){k(s=>[...s,{role:"assistant",content:"âŒ Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",error:!0}])}finally{E(!1)}},L=[{icon:o,label:"Ø§Ù„Ù…Ø³Ø§Ø­Ø©",query:"ÙƒÙ… Ù…Ø³Ø§Ø­Ø© Ù…ØªØ¨Ù‚ÙŠØ©ØŸ",color:"#3b82f6"},{icon:d,label:"Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª",query:"ÙƒÙ… Ù…Ù„Ù Ø¹Ù†Ø¯ÙŠØŸ",color:"#10b981"},{icon:m,label:"Ø£ÙƒØ¨Ø± Ø§Ù„Ù…Ù„ÙØ§Øª",query:"Ù…Ø§ Ù‡ÙŠ Ø£ÙƒØ¨Ø± Ø§Ù„Ù…Ù„ÙØ§ØªØŸ",color:"#f59e0b"},{icon:r,label:"ØªÙ†Ø¸ÙŠÙ…",query:"ÙƒÙŠÙ Ø£Ù†Ø¸Ù… Ù…Ù„ÙØ§ØªÙŠØŸ",color:"#8b5cf6"},{icon:u,label:"Ø¨Ø­Ø«",query:"Ø§Ø¨Ø­Ø« Ø¹Ù† ",color:"#ec4899"},{icon:h,label:"Ù…Ø³Ø§Ø¹Ø¯Ø©",query:"Ù…Ø³Ø§Ø¹Ø¯Ø©",color:"#6366f1"}];return p?a.jsx("div",{className:"smart-assistant-overlay",onClick:b,children:a.jsxs("div",{className:"smart-assistant modern",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"assistant-header",children:[a.jsxs("div",{className:"header-content",children:[a.jsx("div",{className:"assistant-avatar",children:a.jsx(e,{})}),a.jsxs("div",{className:"assistant-info",children:[a.jsx("h3",{children:"Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ"}),a.jsx("span",{className:"status-badge "+((null==W?void 0:W.aiEnabled)?"ai":"local"),children:(null==W?void 0:W.aiEnabled)?`${(null==(g=W.provider)?void 0:g.name)||"AI"}`:"ÙˆØ¶Ø¹ Ù…Ø­Ù„ÙŠ"})]})]}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{k([{role:"assistant",content:K()}])},title:"Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©",className:"icon-btn",children:a.jsx(t,{})}),a.jsx("button",{onClick:b,title:"Ø¥ØºÙ„Ø§Ù‚",className:"icon-btn close",children:a.jsx(n,{})})]})]}),z&&a.jsxs("div",{className:"stats-bar",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx(l,{}),a.jsxs("span",{children:[z.total," Ù…Ù„Ù"]})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx(i,{}),a.jsxs("span",{children:[(null==(y=z.summary)?void 0:y.images)||0," ØµÙˆØ±Ø©"]})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx(r,{}),a.jsxs("span",{children:[(null==(f=z.summary)?void 0:f.documents)||0," Ù…Ø³ØªÙ†Ø¯"]})]})]}),a.jsxs("div",{className:"assistant-messages",children:[q.map((s,t)=>{return a.jsxs("div",{className:`message ${s.role} ${s.error?"error":""}`,children:["assistant"===s.role&&a.jsx("div",{className:"message-avatar",children:a.jsx(e,{})}),a.jsxs("div",{className:"message-bubble",children:[a.jsx("div",{className:"message-content",children:(n=s.content,n?n.split("\n").map((s,e)=>{var t;if(s.startsWith("**")&&s.endsWith("**"))return a.jsx("div",{className:"msg-title",children:s.slice(2,-2)},e);if(s.includes(":**")){const n=s.split(":**");return a.jsxs("div",{className:"msg-section",children:[a.jsxs("span",{className:"section-title",children:[n[0].replace("**",""),":"]}),a.jsx("span",{children:null==(t=n[1])?void 0:t.replace("**","")})]},e)}if(s.startsWith("â€¢")||s.startsWith("-")||s.startsWith("*"))return a.jsx("div",{className:"msg-bullet",children:s},e);if(/^\d+\./.test(s))return a.jsx("div",{className:"msg-numbered",children:s},e);if(s.trim()){const t=s.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>");return a.jsx("div",{className:"msg-line",dangerouslySetInnerHTML:{__html:t}},e)}return a.jsx("div",{className:"msg-space"},e)}):null)}),"assistant"===s.role&&!s.error&&a.jsxs("div",{className:"message-actions",children:[a.jsx("button",{onClick:()=>(s=>{navigator.clipboard.writeText(s.replace(/\*\*/g,"").replace(/[â€¢ðŸ“ŠðŸ”ðŸ“ðŸ’¡ðŸ“¦ðŸ’¾ðŸ“ˆâœ¨âš ï¸ðŸ“‚ðŸ–¼ï¸ðŸŽ¬ðŸ“„ðŸŽµðŸ‘‹ðŸŒŸðŸ¤”]/g,"")),null==N||N("ØªÙ… Ø§Ù„Ù†Ø³Ø®","success")})(s.content),title:"Ù†Ø³Ø®",children:a.jsx(c,{})}),s.method&&a.jsx("span",{className:"method-badge",children:"ai"===s.method?"ðŸ¤–":"ðŸ’»"})]})]})]},t);var n}),S&&a.jsxs("div",{className:"message assistant",children:[a.jsx("div",{className:"message-avatar",children:a.jsx(e,{})}),a.jsx("div",{className:"message-bubble loading",children:a.jsxs("div",{className:"typing-dots",children:[a.jsx("span",{}),a.jsx("span",{}),a.jsx("span",{})]})})]}),a.jsx("div",{ref:D})]}),a.jsx("div",{className:"quick-actions-bar",children:L.map((s,e)=>a.jsxs("button",{className:"quick-action-chip",onClick:()=>{var a;"Ø§Ø¨Ø­Ø« Ø¹Ù† "===s.query?(C(s.query),null==(a=H.current)||a.focus()):B(s.query)},disabled:S,style:{"--action-color":s.color},children:[a.jsx(s.icon,{}),a.jsx("span",{children:s.label})]},e))}),a.jsxs("div",{className:"assistant-input-container",children:[a.jsxs("div",{className:"input-wrapper",children:[a.jsx("input",{ref:H,type:"text",placeholder:"Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§...",value:w,onChange:s=>C(s.target.value),onKeyDown:s=>"Enter"===s.key&&!s.shiftKey&&B(),disabled:S}),a.jsx("button",{onClick:()=>B(),disabled:!w.trim()||S,className:"send-button",children:S?a.jsx(x,{className:"spin"}):a.jsx(j,{})})]}),a.jsx("div",{className:"input-hint",children:'Ø§Ø¶ØºØ· Enter Ù„Ù„Ø¥Ø±Ø³Ø§Ù„ â€¢ Ø¬Ø±Ø¨ "ÙƒÙ… Ù…Ø³Ø§Ø­Ø© Ù…ØªØ¨Ù‚ÙŠØ©ØŸ"'})]})]})}):null}export{p as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CodePreview-PXIxbX7-.js","assets/index-BIUdtEPv.js","assets/vendor-X31hiD63.js","assets/icons-jm45AAY8.js","assets/index-hdfG1N8l.css"])))=>i.map(i=>d[i]);
import{j as e,b as s,M as t,N as l,O as a,P as n,u as i,Q as c,R as o,S as r,d,L as x,T as p,c as m,l as h,_ as u}from"./index-BIUdtEPv.js";import{r as j}from"./vendor-X31hiD63.js";import"./icons-jm45AAY8.js";const v=j.lazy(()=>u(()=>import("./CodePreview-PXIxbX7-.js"),__vite__mapDeps([0,1,2,3,4]))),f={js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",java:"java",cpp:"cpp",c:"c",cs:"csharp",html:"html",css:"css",scss:"scss",json:"json",xml:"xml",sql:"sql",sh:"bash",bash:"bash",php:"php",rb:"ruby",go:"go",rs:"rust",swift:"swift",kt:"kotlin",md:"markdown",yaml:"yaml",yml:"yaml",txt:"text",log:"text",ini:"ini",env:"text",gitignore:"text"},b={"application/msword":"word","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"word","application/vnd.ms-excel":"excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"excel","application/vnd.ms-powerpoint":"powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation":"powerpoint"},k=j.memo(function({file:u,fileUrl:k,onClose:g,onDownload:y,onNext:N,onPrev:C,hasNext:M,hasPrev:z,allFiles:S=[]}){var E,$,P,D,L;const[R,A]=j.useState(1),[F,W]=j.useState(0),[_,B]=j.useState(!1),[I,U]=j.useState(""),[q,Y]=j.useState(!1),[O,T]=j.useState(!1),[X,G]=j.useState(0),[K,Q]=j.useState(!1),[V,H]=j.useState({x:0,y:0}),[J,Z]=j.useState(!1),ee=j.useRef({x:0,y:0}),se=j.useRef(null),te=j.useMemo(()=>{const e=u.name.split(".");return e.length>1?e.pop().toLowerCase():""},[u.name]),le=null==(E=u.type)?void 0:E.startsWith("image/"),ae=null==($=u.type)?void 0:$.startsWith("video/"),ne=null==(P=u.type)?void 0:P.startsWith("audio/"),ie=null==(D=u.type)?void 0:D.includes("pdf"),ce=b[u.type],oe=f[te],re=(null==(L=u.type)?void 0:L.startsWith("text/"))||oe,de=["stl","obj","gltf","glb"].includes(te),xe=j.useMemo(()=>S.filter(e=>{var s;return null==(s=e.type)?void 0:s.startsWith("image/")}),[S]);j.useEffect(()=>{re&&k&&(Y(!0),fetch(k).then(e=>e.text()).then(e=>{U(e),Y(!1)}).catch(()=>Y(!1)))},[re,k]);const pe=j.useCallback(e=>{"Escape"===e.key&&(O?T(!1):g()),"ArrowRight"===e.key&&z&&C(),"ArrowLeft"===e.key&&M&&N(),"+"!==e.key&&"="!==e.key||A(e=>Math.min(e+.25,3)),"-"===e.key&&A(e=>Math.max(e-.25,.5)),"r"===e.key&&W(e=>e+90),"f"===e.key&&me()," "===e.key&&le&&xe.length>1&&(e.preventDefault(),T(!O))},[g,N,C,M,z,O,le,xe.length]);j.useEffect(()=>(window.addEventListener("keydown",pe),()=>window.removeEventListener("keydown",pe)),[pe]),j.useEffect(()=>{if(O&&xe.length>1){const e=setInterval(()=>{G(e=>(e+1)%xe.length)},3e3);return()=>clearInterval(e)}},[O,xe.length]);const me=j.useCallback(()=>{document.fullscreenElement?(document.exitFullscreen(),B(!1)):(document.documentElement.requestFullscreen(),B(!0))},[]),he=j.useCallback(()=>{A(1),W(0),H({x:0,y:0})},[]),ue=j.useCallback(e=>{R>1&&(Z(!0),ee.current={x:e.clientX-V.x,y:e.clientY-V.y})},[R,V]),je=j.useCallback(e=>{J&&R>1&&H({x:e.clientX-ee.current.x,y:e.clientY-ee.current.y})},[J,R]),ve=j.useCallback(()=>{Z(!1)},[]),fe=j.useCallback(e=>{if(le){e.preventDefault();const s=e.deltaY>0?-.1:.1;A(e=>Math.min(Math.max(e+s,.5),3))}},[le]);j.useEffect(()=>{R<=1&&H({x:0,y:0})},[R]);const be=j.useCallback(()=>g(),[g]),ke=j.useCallback(e=>e.stopPropagation(),[]),we=j.useCallback(e=>`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(e)}`,[]);if(j.useCallback((e,s)=>{let t=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return["function","const","let","var","if","else","for","while","return","import","export","from","class","extends","new","this","async","await","try","catch","throw","true","false","null","undefined"].forEach(e=>{t=t.replace(new RegExp(`\\b(${e})\\b`,"g"),'<span class="code-keyword">$1</span>')}),t=t.replace(/(["'`])(?:(?!\1)[^\\]|\\.)*\1/g,'<span class="code-string">$&</span>'),t=t.replace(/(\/\/.*$|\/\*[\s\S]*?\*\/)/gm,'<span class="code-comment">$1</span>'),t=t.replace(/\b(\d+\.?\d*)\b/g,'<span class="code-number">$1</span>'),t},[]),O&&xe.length>0){const t=xe[X];return e.jsx("div",{className:"slideshow-overlay",onClick:()=>T(!1),children:e.jsxs("div",{className:"slideshow-container",children:[e.jsx("img",{src:t.url||k,alt:t.name,className:"slideshow-image"}),e.jsxs("div",{className:"slideshow-controls",children:[e.jsxs("span",{children:[X+1," / ",xe.length]}),e.jsxs("button",{onClick:e=>{e.stopPropagation(),T(!1)},children:[e.jsx(s,{})," إيقاف"]})]}),e.jsx("div",{className:"slideshow-dots",children:xe.map((s,t)=>e.jsx("button",{className:"dot "+(t===X?"active":""),onClick:e=>{e.stopPropagation(),G(t)}},t))})]})})}return e.jsx("div",{className:"preview-overlay",onClick:be,children:e.jsxs("div",{className:"preview-container",onClick:ke,children:[e.jsxs("div",{className:"preview-header",children:[e.jsx("span",{className:"preview-filename",children:u.name}),e.jsxs("div",{className:"preview-actions",children:[le&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>A(e=>Math.min(e+.25,3)),title:"تكبير",children:e.jsx(t,{})}),e.jsx("button",{onClick:()=>A(e=>Math.max(e-.25,.5)),title:"تصغير",children:e.jsx(l,{})}),e.jsx("button",{onClick:()=>W(e=>e+90),title:"تدوير",children:e.jsx(a,{})}),xe.length>1&&e.jsx("button",{onClick:()=>T(!0),title:"عرض شرائح",children:e.jsx(n,{})}),e.jsx("button",{onClick:he,title:"إعادة تعيين",children:e.jsx(i,{})})]}),e.jsx("button",{onClick:()=>Q(!K),title:"معلومات الملف",className:K?"active":"",children:e.jsx(c,{})}),e.jsx("button",{onClick:me,title:"ملء الشاشة",children:_?e.jsx(o,{}):e.jsx(r,{})}),e.jsx("button",{onClick:y,title:"تحميل",children:e.jsx(d,{})}),e.jsx("button",{onClick:g,title:"إغلاق",children:e.jsx(s,{})})]})]}),K&&e.jsxs("div",{className:"preview-file-info",children:[e.jsx("div",{className:"file-name",children:u.name}),e.jsxs("div",{className:"file-meta",children:[e.jsx("span",{children:w(u.size)}),e.jsx("span",{children:u.type||te})]}),u.createdAt&&e.jsxs("div",{className:"file-date",children:["تاريخ الإنشاء: ",new Date(u.createdAt).toLocaleDateString("ar-SA")]})]}),e.jsxs("div",{className:"preview-content",children:[z&&e.jsx("button",{className:"preview-nav prev",onClick:C,children:e.jsx(x,{})}),e.jsxs("div",{className:"preview-media",children:[le&&e.jsx("div",{className:"preview-image-container "+(R>1?"zoomed":""),onMouseDown:ue,onMouseMove:je,onMouseUp:ve,onMouseLeave:ve,onWheel:fe,children:e.jsx("img",{ref:se,src:k,alt:u.name,loading:"lazy",className:R>1?"zoomed":"",style:{transform:`scale(${R}) rotate(${F}deg) translate(${V.x/R}px, ${V.y/R}px)`,transition:J?"none":"transform 0.3s ease",cursor:R>1?J?"grabbing":"grab":"default"},onDoubleClick:he,draggable:!1})}),ae&&e.jsx("video",{src:k,controls:!0,autoPlay:!0}),ne&&e.jsxs("div",{className:"audio-preview",children:[e.jsx("div",{className:"audio-visualizer",children:e.jsx(p,{size:80})}),e.jsx("p",{className:"audio-name",children:u.name}),e.jsx("audio",{src:k,controls:!0,autoPlay:!0})]}),ie&&e.jsx("iframe",{src:k,title:u.name,loading:"lazy"}),ce&&e.jsxs("div",{className:"office-preview",children:[e.jsx("iframe",{src:we(k),title:u.name,loading:"lazy"}),e.jsxs("div",{className:"office-fallback",children:[e.jsx("p",{children:"إذا لم تظهر المعاينة، "}),e.jsx("button",{onClick:y,children:"حمّل الملف"})]})]}),re&&!ce&&e.jsx("div",{className:"code-preview-wrapper",children:q?e.jsx("div",{className:"code-loading",children:"جاري التحميل..."}):e.jsx(j.Suspense,{fallback:e.jsx("div",{className:"code-loading",children:"جاري التحميل..."}),children:e.jsx(v,{code:I,filename:u.name})})}),de&&e.jsx("div",{className:"preview-3d",children:e.jsxs("div",{className:"preview-3d-placeholder",children:[e.jsx(m,{size:80}),e.jsx("p",{children:"معاينة ملفات 3D"}),e.jsx("small",{children:te.toUpperCase()}),e.jsx("button",{onClick:y,children:"تحميل للعرض"})]})}),!le&&!ae&&!ne&&!ie&&!ce&&!re&&!de&&e.jsxs("div",{className:"no-preview",children:[e.jsx(m,{size:80}),e.jsx("p",{children:"لا يمكن معاينة هذا الملف"}),e.jsx("small",{children:u.type||"نوع غير معروف"}),e.jsx("button",{onClick:y,children:"تحميل الملف"})]})]}),M&&e.jsx("button",{className:"preview-nav next",onClick:N,children:e.jsx(h,{})})]}),le&&e.jsxs("div",{className:"preview-zoom-controls",children:[e.jsx("button",{onClick:()=>A(e=>Math.max(e-.25,.5)),title:"تصغير",children:e.jsx(l,{})}),e.jsxs("span",{className:"zoom-level",children:[Math.round(100*R),"%"]}),e.jsx("button",{onClick:()=>A(e=>Math.min(e+.25,3)),title:"تكبير",children:e.jsx(t,{})}),e.jsx("button",{onClick:()=>W(e=>e+90),title:"تدوير",children:e.jsx(a,{})}),e.jsx("button",{onClick:he,title:"إعادة تعيين",children:e.jsx(i,{})})]}),e.jsxs("div",{className:"preview-footer",children:[e.jsx("span",{className:"file-size",children:w(u.size)}),e.jsx("span",{className:"file-type",children:u.type||te})]}),e.jsxs("div",{className:"preview-shortcuts",children:[e.jsx("kbd",{children:"←"}),e.jsx("kbd",{children:"→"})," تنقل |",e.jsx("kbd",{children:"+"}),e.jsx("kbd",{children:"-"})," زوم |",e.jsx("kbd",{children:"R"})," تدوير |",e.jsx("kbd",{children:"F"})," ملء الشاشة |",e.jsx("kbd",{children:"Esc"})," إغلاق"]})]})})});function w(e){if(!e)return"";const s=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,s)).toFixed(1)} ${["B","KB","MB","GB"][s]}`}export{k as default};
